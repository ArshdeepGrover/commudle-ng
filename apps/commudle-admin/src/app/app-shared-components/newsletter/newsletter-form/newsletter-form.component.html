<div class="back-button" (click)="backPage()">
  <fa-icon [icon]="icons.faChevronLeft" class="com-mr-1"></fa-icon> Back to list of newsletter
</div>
<h6>Create Newsletter</h6>
<form [formGroup]="newsletterForm">
  <div class="title">
    <label for="title">Title*</label>
    <input type="text" formControlName="title" nbInput fullWidth placeholder="Title" />
    <commudle-alert
      *ngIf="
        newsletterForm.controls['title'].touched &&
        newsletterForm.controls['title'].hasError('required') &&
        newsletterForm.controls['title'].invalid
      "
      errorMessage="Title is Required"
      [error]="true"
    ></commudle-alert>
  </div>

  <div class="brief-description">
    <label for="brief_description">Brief Description*</label>
    <textarea
      type="text"
      formControlName="brief_description"
      nbInput
      fullWidth
      placeholder="Brief Description for newsletter"
    >
    </textarea>
    <commudle-alert
      *ngIf="newsletterForm.controls['brief_description'].hasError('maxlength')"
      errorMessage="Brief Description cannot exceed 50 characters"
      [error]="true"
    ></commudle-alert>
    <commudle-alert
      *ngIf="
        newsletterForm.controls['brief_description'].touched &&
        newsletterForm.controls['brief_description'].hasError('required') &&
        newsletterForm.controls['brief_description'].invalid
      "
      errorMessage="Brief Description is Required"
      [error]="true"
    ></commudle-alert>
  </div>

  <div class="email-subject">
    <label for="email_subject">Email Subject*</label>
    <input type="text" formControlName="email_subject" nbInput fullWidth placeholder="Email Subject" />
    <commudle-alert
      *ngIf="
        newsletterForm.controls['email_subject'].touched &&
        newsletterForm.controls['email_subject'].hasError('required') &&
        newsletterForm.controls['email_subject'].invalid
      "
      errorMessage="Email Subject is Required"
      [error]="true"
    ></commudle-alert>
  </div>

  <div class="banner-image">
    <label for="banner_image">Banner Image</label>
    <input type="file" (change)="onFileChange($event)" accept="image/*" />
  </div>
  <div *ngIf="imagePreview || newsletterForm.controls['banner_image'].value" class="image-preview">
    <commudle-banner-image
      [headerImagePath]="imagePreview || newsletterForm.controls['banner_image'].value"
    ></commudle-banner-image>
  </div>

  <div class="content">
    <label for="content">Content*</label>
    <div id="gjs"></div>
  </div>
</form>
<section>
  <div class="action-buttons">
    <button
      nbButton
      status="primary"
      (click)="newsletterForm.controls['published'].setValue(true); createOrUpdate()"
      [disabled]="!newsletterForm.valid"
    >
      Save
    </button>
    <button
      nbButton
      status="primary"
      (click)="newsletterForm.controls['published'].setValue(false); createOrUpdate()"
      [disabled]="!newsletterForm.valid"
    >
      Save As Draft
    </button>
  </div>
  <div class="back-button" (click)="backPage()">
    <fa-icon [icon]="icons.faChevronLeft" class="com-mr-1"></fa-icon> Back to list of newsletter
  </div>
</section>

<ng-template #cancelDialogBox let-ref="dialogRef">
  <nb-card>
    <nb-card-body>
      <div>Are you sure you want to discard changes?</div>
    </nb-card-body>
    <nb-card-footer class="action-buttons !com-my-0">
      <button nbButton status="primary" (click)="backPage(); ref.close()">Yes</button>
      <button nbButton status="danger" (click)="ref.close()">No</button>
    </nb-card-footer>
  </nb-card>
</ng-template>
