<div class="session-page-container">
  <div class="session-page">
    <app-session-page-video
      *ngIf="embeddedVideoStream"
      [chat]="chat"
      [community]="community"
      [currentUser]="currentUser"
      [embeddedVideoStream]="embeddedVideoStream"
      [endTime]="endTime"
      [event]="event"
      [pollableId]="pollableId"
      [pollableType]="pollableType"
      [qna]="discussion"
      [speaker]="speaker"
      [startTime]="startTime"
      [trackSlot]="trackSlot"
      [userRoles]="userRoles"
    ></app-session-page-video>
    <app-session-page-details
      *ngIf="
        !['commudle', 'youtube'].includes(embeddedVideoStream?.source) ||
        (!trackSlot?.embedded_video_stream && !embeddedVideoStream)
      "
      [community]="community"
      [endTime]="endTime"
      [event]="event"
      [speaker]="speaker"
      [startTime]="startTime"
      [trackSlot]="trackSlot"
    ></app-session-page-details>
    <div
      *ngIf="
        !['commudle', 'youtube'].includes(embeddedVideoStream?.source) ||
        (!trackSlot?.embedded_video_stream && !embeddedVideoStream)
      "
    >
      <div #interactionWindow class="session-page-window remove-overflow session-chat">
        <div class="actions d-flex align-items-center justify-content-space-between">
          <p class="heading">Chat with other Viewers</p>
        </div>
        <app-session-page-chat
          (newMessage)="newMessage = getInteractionWindowStatus(1)"
          [chat]="chat"
        ></app-session-page-chat>
      </div>
      <div #interactionWindow class="session-page-window">
        <div class="actions d-flex align-items-center justify-content-space-between">
          <p class="heading">Ask a Question</p>
        </div>
        <app-session-page-qna
          (newQna)="newQna = getInteractionWindowStatus(2)"
          [qna]="discussion"
        ></app-session-page-qna>
      </div>
      <div #interactionWindow class="session-page-window">
        <div class="actions d-flex align-items-center justify-content-space-between">
          <p class="heading">Participate in Polls</p>
        </div>
        <app-session-page-poll [pollableId]="pollableId" [pollableType]="pollableType"></app-session-page-poll>
      </div>
      <div class="user-interactions">
        <button
          (click)="toggleInteractionWindow(1)"
          [ngClass]="{ active: !getInteractionWindowStatus(1) }"
          nbButton
          nbTooltip="Messages"
          shape="round"
        >
          <nb-badge [dotMode]="true" [ngClass]="{ notification: newMessage }" status="info"></nb-badge>
          <nb-icon icon="message-circle-outline"></nb-icon>
        </button>
        <button
          (click)="toggleInteractionWindow(2)"
          [ngClass]="{ active: !getInteractionWindowStatus(2) }"
          nbButton
          nbTooltip="QnA"
          shape="round"
        >
          <nb-badge [dotMode]="true" [ngClass]="{ notification: newQna }" status="info"></nb-badge>
          Q
        </button>
        <button
          (click)="toggleInteractionWindow(3)"
          [ngClass]="{ active: !getInteractionWindowStatus(3) }"
          nbButton
          nbTooltip="Polls"
          shape="round"
        >
          <nb-badge [dotMode]="true" [ngClass]="{ notification: newPoll }" status="info"></nb-badge>
          <nb-icon icon="bar-chart"></nb-icon>
        </button>
      </div>
    </div>
    <app-auto-attendance
      *ngIf="moment().isBetween(moment(event?.start_time), moment(event?.end_time))"
      [eventId]="event.id"
    ></app-auto-attendance>
  </div>
</div>
