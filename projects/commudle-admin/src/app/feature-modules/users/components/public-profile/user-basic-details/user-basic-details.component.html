<nb-card class="user-details-container">
  <nb-card-body>
    <div class="com-flex com-flex-col md:com-flex-row com-gap-8">
      <img [alt]="user.name" [src]="user.avatar" [title]="user.name" class="user-avatar" />
      <div class="user-info">
        <div class="com-flex com-flex-col md:com-flex-row com-items-center com-justify-between com-gap-4">
          <div class="name">
            <h1>{{ user.name }}</h1>
            <img
              *ngIf="user.is_expert"
              alt="Expert Tick"
              class="expert-icon"
              src="/assets/images/Expert-Tick.svg"
              title="Expert Tick"
            />
          </div>
          <div class="com-space-x-2">
            <a
              *ngIf="currentUser?.id === user.id"
              [routerLink]="[{ outlets: { p: ['settings', 'basic-details'] } }]"
              nbButton
              size="small"
            >
              <nb-icon icon="edit-outline"></nb-icon>
              Edit Profile
            </a>
            <app-share-button
              [content]="environment.app_url + '/users/' + user.username"
              [title]="user.name + ' ' + user.designation"
              [url]="environment.app_url + '/users/' + user.username"
              class="com-inline-block"
            ></app-share-button>
          </div>
        </div>
        <p class="username">@{{ user.username }}</p>
        <nb-tag-list *ngIf="user.tags.length > 0" class="com-mt-6">
          <nb-tag *ngFor="let tag of user.tags" [text]="tag.name"></nb-tag>
          <nb-tag
            (click)="onTagDialogOpen()"
            *ngIf="currentUser?.id === user.id"
            class="com-cursor-pointer"
            text="+"
          ></nb-tag>
        </nb-tag-list>
        <div *ngIf="user.designation" class="designation">
          <nb-icon icon="briefcase-outline"></nb-icon>
          <p>{{ user.designation }}</p>
        </div>
        <div *ngIf="user.location" class="location">
          <nb-icon icon="pin"></nb-icon>
          <p>{{ user.location }}</p>
        </div>
        <div class="network">
          <div class="com-space-x-2 com-text-base md:com-text-lg">
            <a routerLink="followers">{{ user.followers_count || 0 }} Followers</a>
            <a routerLink="following">{{ user.followees_count || 0 }} Following</a>
          </div>
          <div class="com-space-x-2">
            <app-user-follow
              (userFollowed)="updateProfile.emit()"
              [username]="user.username"
              class="com-inline-block"
            ></app-user-follow>
            <button
              (click)="openChatWithUser()"
              *ngIf="currentUser?.id !== user.id"
              nbButton
              size="small"
              status="info"
            >
              <nb-icon icon="paper-plane"></nb-icon>
              Message
            </button>
          </div>
        </div>
      </div>
    </div>
  </nb-card-body>
</nb-card>

<ng-template #editTags let-ref="dialogRef">
  <nb-card class="tag-dialog">
    <nb-card-header class="text-center"> Add tags which define you</nb-card-header>
    <nb-card-body class="text-center">
      <div class="tag-dialog-info">
        <nb-icon icon="info-outline"></nb-icon>
        Add {{ maxTags }} of your skills which you want other developers to see!
      </div>
      <nb-tag-list (tagRemove)="onTagRemove($event)">
        <nb-tag *ngFor="let tag of tagsDialog" [text]="tag" removable></nb-tag>
        <input
          (keypress)="restrictComma($event)"
          (tagAdd)="onTagAdd($event)"
          [separatorKeys]="[13, 188]"
          fullWidth
          nbTagInput
          placeholder="Type a tag and press enter or comma"
          type="text"
        />
      </nb-tag-list>
    </nb-card-body>
    <nb-card-footer class="d-flex justify-content-space-between">
      <button (click)="ref.close()" ghost nbButton status="danger">Cancel</button>
      <button (click)="onTagDialogSubmit()" nbButton status="success">Save</button>
    </nb-card-footer>
  </nb-card>
</ng-template>
