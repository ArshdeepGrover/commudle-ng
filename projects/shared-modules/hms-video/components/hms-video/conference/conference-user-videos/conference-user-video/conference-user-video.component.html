<div class="user-video-container">
  <div
    *ngIf="
      !peer?.isLocal &&
      (localPeer?.roleName === EHmsRoles.HOST || localPeer?.roleName === EHmsRoles.HOST_VIEWER) &&
      !screenShare
    "
    class="video-controls d-flex"
  >
    <button
      (click)="mutePeerAudio()"
      [disabled]="!isAudioEnabled"
      ghost
      nbButton
      nbTooltip="Mute this person's audio"
      nbTooltipTrigger="hover"
      shape="round"
      size="small"
    >
      <nb-icon [icon]="isAudioEnabled ? 'mic' : 'mic-off'"></nb-icon>
    </button>
    <button
      (click)="mutePeerVideo()"
      [disabled]="!isVideoEnabled"
      ghost
      nbButton
      nbTooltip="Mute this person's video"
      nbTooltipTrigger="hover"
      shape="round"
      size="small"
    >
      <nb-icon [icon]="isVideoEnabled ? 'video' : 'video-off'"></nb-icon>
    </button>
    <button
      (click)="changeRole()"
      ghost
      nbButton
      nbTooltip="Remove from stage"
      nbTooltipTrigger="hover"
      shape="round"
      size="small"
    >
      <nb-icon icon="minus-circle"></nb-icon>
    </button>
    <button
      (click)="removeFromSession()"
      ghost
      nbButton
      nbTooltip="Remove from session"
      nbTooltipTrigger="hover"
      shape="round"
      size="small"
    >
      <nb-icon icon="log-out"></nb-icon>
    </button>
  </div>
  <div [ngClass]="{ speaker: isSpeaker }" class="user-video">
    <video
      #videoElement
      [autoplay]="true"
      [muted]="peer?.isLocal"
      [ngClass]="{ hidden: !isVideoEnabled && !screenShare, 'screen-share': screenShare }"
      playsinline
    ></video>
    <img
      *ngIf="metaData && !isVideoEnabled && !screenShare"
      [alt]="metaData.name"
      [src]="metaData.avatar"
      [title]="metaData.name"
      class="user-avatar"
    />
  </div>

  <div *ngIf="metaData" class="user-name">
    <a [routerLink]="['/users', metaData?.username]" target="_blank">
      <nb-icon *ngIf="!isAudioEnabled" icon="mic-off" status="danger"></nb-icon>
      {{ displayText }}
    </a>
    <!-- <app-user-follow [username]="metaData?.username" appearance="outline"></app-user-follow> -->
    <!-- button to follow speaker -->
    <button
      *ngIf="currentUser.id !== metaData.id"
      (click)="toggleFollow(metaData.username)"
      ghost
      nbButton
      shape="round"
      size="small"
      class="!com-text-white"
    >
      <nb-icon [icon]="isFollowing ? 'checkmark' : 'plus'"></nb-icon>
      {{ isFollowing ? 'Following' : 'Follow' }}
      <!-- <nb-icon *ngIf="!isFollowing" icon="plus-outline"></nb-icon>
      <nb-icon *ngIf="isFollowing" icon="checkmark"></nb-icon> -->
    </button>
  </div>
</div>
